<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Play Perl</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <link href="/vendors/bootstrap/css/bootstrap.css" rel="stylesheet">
    <link href="/vendors/fontawesome/css/font-awesome.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
      }
    </style>
    <link href="/vendors/bootstrap/css/bootstrap-responsive.css" rel="stylesheet">
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link href="/css/common.css" rel="stylesheet">

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/vendors/bootstrap/ico/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/vendors/bootstrap/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/vendors/bootstrap/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/vendors/bootstrap/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="/vendors/bootstrap/ico/apple-touch-icon-57-precomposed.png">

    <!-- notification messages -->
    <script type="text/template" id="template-error">
        <div class="alert alert-error">
          <button type="button" class="close" data-dismiss="alert">×</button>
          <% if (response && response.error) { %>
            <%= response.error %>
          <% } else { %>
            Unknown error
          <% } %>
        </div>
    </script>

    <script type="text/template" id="template-notify">
        <div class="alert alert-notify">
          <button type="button" class="close" data-dismiss="alert">×</button>
          <%= text %>
        </div>
    </script>

    <!-- main container with navbar -->
    <script type="text/template" id="template-app">
        <div class="navbar navbar-inverse navbar-fixed-top">
          <div class="navbar-inner">
            <div class="container">
              <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </a>
              <a class="brand" href="/">Play Perl</a>
              <div class="nav-collapse collapse">
                <ul class="nav">
                  <li class="active menu-item-home"><a href="/">Home</a></li>
                  <li class="menu-item-event-list"><a href="/feed">News Feed</a></li>
                  <li class="menu-item-user-list"><a href="/players">Players</a></li>
                  <li class="menu-item-about"><a href="/about">About</a></li>
                </ul>
                <p class="navbar-text pull-right"></p>
                    <ul class="nav pull-right current-user-box">
                    </ul>
              </div><!--/.nav-collapse -->
            </div>
          </div>
        </div>
        <div class="app-view-container container"></div>
    </script>

    <!-- current user widget from right-top corner -->
    <script type="text/template" id="template-current-user">
        <li class="dropdown">
            <% if (registered === 1) { %>
                <a href="/" class="dropdown-toggle" data-toggle="dropdown"><%= login %></a>
                <ul class="dropdown-menu">
                    <li>
                        <a href="#" class="logout">Logout</a>
                    </li>
                </ul>
            <% } else { %>
                <a href="/auth/twitter">Login with <i class="icon-twitter icon-large"></i></a>
            <% } %>
        </li>
    </script>

    <!-- landing page -->
    <script type="text/template" id="template-home">
        <div class="container-fluid hero-unit">
            <h1>Play Perl</h1>
            <h2>What&apos;s going on here?</h2>
            <p>
            <ol>
                <li>This is your public to-do list.</li>
                <li>This is a gamified platform for connecting and encouraging people.</li>
                <li>This is a social network for Perl developers.</li>
                <li>This is a place to gather and provide feedback on the stuff you did and on the stuff you&apos;re going to do.</li>
                <li>Finally, you can get game points here!</li>
            </ol>
            </p>
            <p>
            <a href="/auth/twitter" class="btn btn-large btn-primary">Login with Twitter</a>
            </p>
        </div>
    </script>

    <script type="text/template" id="template-about">
      <div class="container-fluid about">
        <h1>Play Perl</h1>
        <div>
          Play Perl is a new website for Perl developers.
        </div>
        <hr>
        <div class="row-fluid">
          <h2>Opensource, gamified</h2>
          <p>
          Gamification is great for tuning people motivations in a positive way.<br>
          Play Perl gives you points and achievements to be proud of.
          </p>
        </div>
        <div class='row-fluid'>
          <h2>Social Todo List</h2>
          <p>
          Play Perl allows you to announce your plans, gather the feedback, and find other people to cooperate with on common goals.
          </p>
        </div>
        <div class="row-fluid">
          <h2>Collaborative prioritization</h2>
          <p>
          By liking other people's quests, you promise them points, — or give them points right now if they already completed the quest.<br>
          So you can quickly gather opinions on what the community would like to be see more - new feature, internals refactoring, or new blog post.
          </p>
        </div>
        <hr>
        <div class="row-fluid">
          <h2>FAQ</h2>
          <dl>
            <dt>"Quest"? "Player"? What is this?</dt>
            <dd>Quest is any kind of task you're planning to do. Player is you, and other people are players too. You get 1+{number-of-likes} points for each quest you close.</dd>
            <dt>There are many other bug trackers! How is Play Perl different?</dt>
            <dd>
            Play Perl considers people to be more important than projects, and fun to be more important than planning. We're going to optimize its mechanics for:
            <ol>
              <li>People feeling appreciated;</li>
              <li>Praise being granted and received wherever and whenever necessary;</li>
              <li>Contribution simplified as much as possible.</li>
            </ol>
            There are many more ideas for future features, check out our <a href="https://github.com/berekuk/play-perl/wiki/DesignDraft">DesignDraft</a>.
            </dd>
            <dt>I don't have a Twitter account.</dt>
            <dd>Get one or wait until we implement other means of authentification. Or you can <a href="https://github.com/berekuk/play-perl/issues/7">contribute</a>.</dd>
            <dt>Is this for Perl 5 or for Perl 6?</dt>
            <dd>Both.</dd>
            <dt>This doesn't motivate me.</dt>
            <dd>That's ok. <a href="http://berekuk.github.com/perl-motivation-survey/">People are different.</a></dd>
            <dt>I can't use this without feature X.</dt>
            <dd>Can you <a href="https://github.com/berekuk/play-perl">implement it yourself?</a></dd>
          </div>
          <hr>
          <div class="row-fluid">
            <h2>Technology</h2>
            Play Perl is built with:
            <ul>
              <li><a href="http://perldancer.org/">Dancer</a></li>
              <li><a href="http://documentcloud.github.com/backbone/">Backbone.js</a></li>
              <li><a href="http://twitter.github.com/bootstrap/">Bootstrap</a></li>
              <li><a href="http://www.mongodb.org/">MongoDB</a></li>
            </ul>
            <div>
              Backend is completely separated from the frontend. Backend API is documented <a href="https://github.com/berekuk/play-perl/blob/master/app/api.txt">here</a>, feel free to use it.<br>
              (But please don't abuse game mechanics or you'll be banned.)
            </div>
            <div>
              <br>
              Play Perl sources are open. <a href="https://github.com/berekuk/play-perl">Clone it on GitHub!</a>
          </div>
        </div>
    </script>

    <!-- profile page - user and his/her quests -->
    <script type="text/template" id="template-dashboard">
      <div class="container-fluid">
        <div class="row-fluid">
            <div class="span3">
                <div class="user"></div>
                <div class="new-quest" style="display:none">
                    <button type="button" class="btn btn-primary quest-add-dialog">New quest</button>
                </div>
            </div>
          <div class="span9">
            <div class="open-quests"></div>
            <div class="closed-quests"></div>
          </div>
        </div>
      </div>
    </script>

    <script type="text/template" id="template-user-big">
      <div class="well">
        <% if (typeof(twitter) != 'undefined') {
             if (twitter.screen_name) { %>
        <img src="http://api.twitter.com/1/users/profile_image?screen_name=<%= twitter.screen_name %>&size=bigger" width=73 height=73/>
        <% } } %>
        <h4>
          <%= login %>
          <span class="badge badge-info" data-toggle="tooltip" title='points are granted for each completed quest and each "like" on those quests'><%= points %></span>
        </h4>
      </div>
    </script>

    <script type="text/template" id="template-quest-collection">
        <div>
          <table class="table table-bordered quests-list table-hover" style="display: none"></table>
        </div>
    </script>

    <script type="text/template" id="template-quest-small">
      <td>
        <span class="label label-<%= status === 'open' && 'warning' %>"><%= status %></span>
        <a href="/quest/<%= _id %>"><%= name  %></a>

        <% if (typeof(comment_count) != 'undefined') { %>
          <a href="/quest/<%= _id %>"><span class="badge badge-info"><i class="icon-comment"></i> <%= comment_count %></span></a>
          <% } %>

        <% if (typeof(likes) != 'undefined') { %>
          <% if (likes.length) { %>
            <span class="badge badge-success" data-toggle="tooltip" title="<%= likes.join(', ') %>"><i class="icon-thumbs-up"></i> <%= likes.length %></span>
            <% } %>
          <% } %>

        <% if (typeof(type) != 'undefined') { %>
          <span class="label label-inverse quest-type-label"><%= type %></span>
          <% } %>
      </td>
    </script>

    <!-- registration form -->
    <script type="text/template" id="template-register">
      <div>
        Choose your name:
        <input name="login" type="text" placeholder="Choose your login">
        <button class="btn btn-primary btn-large submit">Register</button>
      </div>
    </script>

    <!-- users list -->
    <script type="text/template" id="template-user-collection">
        <div class="row-fluid">
          <div class="span1">
          </div>
          <div class="span2">
              <button class="btn btn-primary show-switch">
                <%= all ? 'Hide inactive players' : 'Show all players' %>
              </button>
          </div>
          <div class="span6">
          <table class="table table-bordered quests-list">
          <% _.each(users, function(user) { %>
            <tr class="warning">
              <td>
                <% if (user.get("twitter") && user.get("twitter").screen_name) { %>
                <img class="avatar avatar-mini" src="http://api.twitter.com/1/users/profile_image?screen_name=<%= user.get("twitter").screen_name %>&size=mini"/>
                <% } %>
                <a href="/player/<%= user.get("login") %>"><%= user.get("login") %></a>
                <span class="badge badge-info"><%= user.get("points") %></span>
                <% if (user.get("open_quests")) { %>
                  <span class="label label-inverse open-quest-count-label"><%= user.get("open_quests") %> quest<%= user.get("open_quests") > 1 ? 's' : '' %></span>
                <% } %>
              </td>
            </tr>
          <% }); %>
          </table>
        </div>
      </div>
    </script>

    <!-- events list -->
    <script type="text/template" id="template-event-collection">
        <div class="row-fluid events-list" style="display: none">
        </div>
    </script>

    <!-- common box for any event type -->
    <script type="text/template" id="template-event-any">
      <div>
        <div class="subview"></div>
        <time class="timeago" datetime="<%= new Date(ts * 1000).toISOString() %>"><%= new Date(ts * 1000).toISOString() %></time>
        <hr>
      </div>
    </script>

    <script type="text/template" id="template-event-add-quest">
        <%= partial.user({ login: object.user }) %> started a new quest: <a href="/quest/<%= object_id %>"><%= object.name %></a>.
    </script>

    <script type="text/template" id="template-event-close-quest">
        <%= partial.user({ login: object.user }) %> completed a quest: <a href="/quest/<%= object_id %>"><%= object.name %></a>.
    </script>

    <script type="text/template" id="template-event-reopen-quest">
        <%= partial.user({ login: object.user }) %> reopened a quest: <a href="/quest/<%= object_id %>"><%= object.name %></a>.
    </script>

    <script type="text/template" id="template-event-add-comment">
        <%= partial.user({ login: object.author }) %>
        commented on
        <%= partial.user({ login: object.quest.user }) %>'s quest
        <a href="/quest/<%= object.quest._id %>"><%= object.quest.name %></a>:
        <div class="well well-small event-comment-well">
          <%= object.body_html %>
        </div>
    </script>

    <script type="text/template" id="template-quest-add">
      <div>
        <div id="addQuest" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h3>Add a quest</h3>
          </div>
          <div class="modal-body modal-quest-add">
            <div class="row-fluid add-quest-field">
              <small class="muted">Quest type is optional.</small>
              <div class="btn-group quest-type-select">
                <button type="button" class="btn" quest-type="bug">Bug</button>
                <button type="button" class="btn" quest-type="blog">Blog post</button>
                <button type="button" class="btn" quest-type="feature">New feature</button>
              </div>
            </div>
            <div class="row-fluid add-quest-field">
              <small class="muted">Write a short description of the task here. You can add details later in the comments.</small>
              <textarea name="name" rows="3" placeholder="Quest description" class="span12"></textarea>
            </div>
          </div>
          <div class="modal-footer">
            <button class="btn btn-primary quest-add">Go!</button>
          </div>
        </div>
      </div>
    </script>

    <!-- quest details page -->
    <script type="text/template" id="template-quest-page">
      <div class="quest"></div>
      <div class="comments"></div>
    </script>

    <script type="text/template" id="template-quest-big">
      <!-- delete button -->
      <% if (my) { %>
      <button type="button" class="close quest-delete">&times;</button>
      <% } %>

      <h2>
        <span class="quest-title" <% if (my) { %> data-toggle="tooltip" title="double-click to edit" <% } %>><%= name %></span>
        <% if (my) { %>
          <input class="quest-edit" type="text" value="<%= name %>" style="display: none">
        <% } %>
        <span class="quest-label label label-<%= status === 'open' && 'warning' %>"><%= status %></span>
        <% if (typeof(type) != 'undefined') { %>
          <span class="quest-label label label-inverse"><%= type %></span>
        <% } %>
        <!--
        // this code is buggy; because of QuestBig view double rendering issue, 'Tweet' button is often rendered as a broken link
        // also, the current 'Tweet' button location is too annoying
      <% if (my) { %>
        <a
            href="https://twitter.com/share"
            class="twitter-share-button"
            data-lang="en"
            data-url="http://play-perl.org/quest/<%= _id %>"
            data-text="<% if (status === 'open') { %>I've got the new quest:<% } else { %>I've completed the quest:<% } %> <%= name %>" data-hashtags="playperl">Tweet</a>
      <% } %>
      -->
      </h2>
      <div class="likes">
      <% if (!my) {
        var meGusta = false;
        if (currentUser) {
          meGusta = _.contains(likes, currentUser);
        }
      %> <!-- quest belongs to somebody else -->


        <!-- like/unlike button  -->
        <% if (meGusta) { %>
          <button class="btn btn-mini btn-primary quest-unlike" type="button">Unlike</button>
        <% } else { %>
          <button class="btn btn-mini btn-primary quest-like" type="button">Like</button>
        <% } %>

      <% } %>
      <!-- likes count -->
      <% if (likes.length) { %>
          <span class="badge badge-success" data-toggle="tooltip" title="<%= likes.join(', ') %>"><i class="icon-thumbs-up"></i> <%= likes.length %></span>
      <% } %>
      </div>

      <% if (my) { %> <!-- quest belongs to the current user -->

        <div>
        <!-- close/reopen button -->
        <% if (status === 'open') { %>
          <button class="quest-close btn btn-primary">Complete</button>
        <% } %>
          <% if (status === 'closed') { %>
        <button class="quest-reopen btn btn-primary">Reopen</button>
        <% } %>
        </div>

      <% } %>
    </script>

    <script type="text/template" id="template-comment-collection">
      <div class="comments-list" style="display:none">
      </div>
      <div class="comment-add">
        <textarea name="comment" rows="3" placeholder="Comment (Markdown syntax supported)" class="span6"></textarea>
        <div>
          <button class="btn btn-primary btn-large submit disabled">Add comment</button>
        </div>
      </div>
    </script>

    <script type="text/template" id="template-comment">
      <div class="well well-small">
        <% if (my) { %>
        <button type="button" class="close comment-delete">&times;</button>
        <% } %>
        <p>
        <%= body_html %>
        </p>
        <%= partial.user({ login: author }) %>
        <% if (typeof(ts) != 'undefined') { %>
        <time class="timeago" datetime="<%= new Date(ts * 1000).toISOString() %>"><%= new Date(ts * 1000).toISOString() %></time>
        <% } %>
      </div>
    </script>

    <script type="text/template" id="partial-user"><a href="/player/<%= login %>" class="label"><%= login %></a></script>

    <!-- Google Analytics -->
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-36251424-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
     </script>

  </head>

  <body>
    <div id="layout"></div>

    <script src="/vendors/jquery-1.7.1.min.js"></script>
    <script src="/vendors/bootstrap/js/bootstrap.min.js"></script>
    <script src="/vendors/bootbox.min.js"></script>
    <script src="/vendors/underscore-min.js"></script>
    <script src="/vendors/backbone-min.js"></script>
    <script src="/vendors/jquery.cookie.js"></script>
    <script src="/vendors/jquery.timeago.js"></script>

    <script>
        var pp = {
            app: {},
            models: {},
            views: {},
            View: {}
        };
    </script>

    <script src="/views/proto.js"></script>
    <script src="/views/app.js"></script>
    <script src="/views/comment/collection.js"></script>
    <script src="/views/comment/normal.js"></script>
    <script src="/views/dashboard.js"></script>
    <script src="/views/error.js"></script>
    <script src="/views/home.js"></script>
    <script src="/views/notify.js"></script>
    <script src="/views/quest/add.js"></script>
    <script src="/views/quest/big.js"></script>
    <script src="/views/quest/collection.js"></script>
    <script src="/views/quest/page.js"></script>
    <script src="/views/quest/small.js"></script>
    <script src="/views/register.js"></script>
    <script src="/views/user/current.js"></script>
    <script src="/views/user/big.js"></script>
    <script src="/views/user/collection.js"></script>
    <script src="/views/event/box.js"></script>
    <script src="/views/event/normal.js"></script>
    <script src="/views/event/collection.js"></script>
    <script src="/views/about.js"></script>

    <script src="/models/user.js"></script>
    <script src="/models/another-user.js"></script>
    <script src="/models/current-user.js"></script>
    <script src="/models/user-collection.js"></script>
    <script src="/models/event.js"></script>
    <script src="/models/event-collection.js"></script>
    <script src="/models/comment.js"></script>
    <script src="/models/comment-collection.js"></script>
    <script src="/models/quest.js"></script>
    <script src="/models/quest-collection.js"></script>

    <script src="/app.js"></script>

  </body>
</html>
